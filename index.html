<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>아랍어 타자 연습</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f3f3f3;
      color: #111;
      display: flex;
      justify-content: center;
      align-items: stretch;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      width: 100%;
      max-width: 1100px;
      background: #fff;
      border-radius: 16px;
      padding: 20px 24px 28px;
      box-shadow: 0 10px 26px rgba(0,0,0,0.08);
      display: flex;
      flex-direction: column;
      min-height: 90vh;
    }

    .app-title {
      text-align: center;
      font-size: 1.6rem;
      font-weight: 700;
      margin-bottom: 14px;
    }

    /* 메인 탭: 한 줄 정렬 */
    .main-tabs {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-bottom: 18px;
      flex-wrap: nowrap;
      white-space: nowrap;
    }

    .main-tab-btn {
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid #ccc;
      background: #fafafa;
      font-size: 0.85rem;
      cursor: pointer;
    }

    .main-tab-btn.active {
      background: #2196f3;
      border-color: #2196f3;
      color: #fff;
    }

    .tab-section {
      flex: 1;
      display: none;
    }

    .tab-section.active {
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      min-height: 0;
    }

    /* ===== 공통 레이아웃 (연습) ===== */

    .mode-title {
      text-align: center;
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 14px;
    }

    .center-wrap {
      max-width: 780px;
      margin: 0 auto;
      text-align: center;
      display: flex;
      flex-direction: column;
      gap: 14px;
      flex: 1;
    }

    .info-text {
      font-size: 0.9rem;
      color: #666;
      margin-bottom: 4px;
    }

    .box {
      background: #f1f1f1;
      border-radius: 10px;
      padding: 12px 14px;
      text-align: center;
    }

    /* 한국어 뜻 + 아랍어 하나의 블록 */
    .combined-box {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .meaning-line {
      font-size: 1rem;
      color: #333;
    }

    .arabic-line {
      font-size: 1.6rem;
      direction: rtl;
      text-align: center;
      color: #111;
      word-wrap: break-word;
      line-height: 1.8;
    }

    .typed-display {
      min-height: 34px;
      font-size: 1.6rem;
      direction: rtl;
      text-align: center;
      word-wrap: break-word;
      line-height: 1.8;
    }

    .input-area {
      margin-top: 6px;
    }

    .typing-input {
      width: 100%;
      max-width: 640px;
      padding: 10px 12px;
      font-size: 1.2rem;
      direction: rtl;
      text-align: center;
      border-radius: 10px;
      border: 1px solid #ccc;
      outline: none;
    }

    .typing-input:focus {
      border-color: #2196f3;
      box-shadow: 0 0 0 2px rgba(33,150,243,0.12);
    }

    .bottom-row {
      margin-top: 14px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      font-size: 0.9rem;
      color: #666;
      flex-wrap: wrap;
    }

    .stats {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      justify-content: flex-start;
    }

    .btn {
      padding: 8px 16px;
      border-radius: 999px;
      border: none;
      background: #2196f3;
      color: #fff;
      cursor: pointer;
      font-size: 0.9rem;
      white-space: nowrap;
    }

    .btn:active {
      transform: translateY(1px);
    }

    .correct-char {
      color: #111;
    }

    .wrong-char {
      color: #e53935;
    }

    /* ===== 게임 영역 ===== */

    .game-title {
      text-align: center;
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .game-desc {
      text-align: center;
      font-size: 0.9rem;
      color: #666;
      margin-bottom: 14px;
    }

    .game-inner-tabs {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }

    .game-tab-btn {
      padding: 6px 14px;
      border-radius: 999px;
      border: 1px solid #ccc;
      background: #fafafa;
      font-size: 0.85rem;
      cursor: pointer;
    }

    .game-tab-btn.active {
      background: #ff9800;
      border-color: #ff9800;
      color: #fff;
    }

    .game-content {
      flex: 1;
      display: none;
      flex-direction: column;
    }

    .game-content.active {
      display: flex;
      flex-direction: column;
    }

    .game-center-wrap {
      max-width: 780px;
      margin: 0 auto;
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 12px;
      text-align: center;
    }

    .game-meaning-box {
      background: #f1f1f1;
      border-radius: 10px;
      padding: 10px 14px;
      font-size: 0.95rem;
      color: #333;
    }

    .game-arabic-box {
      background: #f1f1f1;
      border-radius: 10px;
      padding: 10px 14px;
      font-size: 1.5rem;
      direction: rtl;
      text-align: center;
      color: #111;
      word-wrap: break-word;
      line-height: 1.7;
    }

    .game-typed-display {
      min-height: 30px;
      font-size: 1.5rem;
      direction: rtl;
      text-align: center;
      word-wrap: break-word;
      line-height: 1.7;
    }

    .game-input {
      width: 100%;
      max-width: 640px;
      padding: 8px 11px;
      font-size: 1.1rem;
      direction: rtl;
      text-align: center;
      border-radius: 10px;
      border: 1px solid #ccc;
      outline: none;
    }

    .game-input:focus {
      border-color: #ff9800;
      box-shadow: 0 0 0 2px rgba(255,152,0,0.18);
    }

    .game-stats-row {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
      font-size: 0.9rem;
      color: #666;
      align-items: center;
    }

    /* 떨어지는 단어용 영역 */
    .fall-wrapper {
      position: relative;
      height: 220px;
      overflow: hidden;
      border-radius: 12px;
      background: #fafafa;
      margin-top: 6px;
      margin-bottom: 4px;
    }

    .fall-word {
      position: absolute;
      right: 50%;
      transform: translate(50%, 0%);
      font-size: 1.9rem;
      direction: rtl;
      text-align: center;
      transition: transform 0.08s linear;
      white-space: nowrap;
    }

    @media (max-width: 768px) {
      body {
        padding: 10px;
      }

      .container {
        padding: 16px 16px 22px;
        min-height: 100vh;
      }

      .app-title {
        font-size: 1.4rem;
      }

      .arabic-line,
      .typed-display,
      .game-arabic-box,
      .game-typed-display,
      .fall-word {
        font-size: 1.4rem;
      }

      .typing-input,
      .game-input {
        font-size: 1.05rem;
      }

      .fall-wrapper {
        height: 260px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="app-title">아랍어 타자 연습</h1>

    <!-- 메인 탭 -->
    <div class="main-tabs">
      <button class="main-tab-btn active" data-tab="word">단어</button>
      <button class="main-tab-btn" data-tab="short">문장</button>
      <button class="main-tab-btn" data-tab="long">긴 글</button>
      <button class="main-tab-btn" data-tab="game">게임 모드</button>
    </div>

    <!-- ===== 연습 탭 ===== -->
    <section class="tab-section active" id="practiceSection">
      <div class="mode-title" id="modeTitle">단어</div>
      <div class="center-wrap">
        <!-- 한국어 뜻 + 아랍어 하나의 회색 박스 -->
        <div>
          <div class="box combined-box">
            <div class="meaning-line" id="practiceMeaning">제 이름은 지훈입니다.</div>
            <div class="arabic-line" id="practiceTarget">اِسْمِي جِهُون.</div>
          </div>
        </div>

        <div>
          <div class="info-text">타이핑 결과</div>
          <div class="typed-display" id="practiceTypedDisplay"></div>
        </div>

        <div class="input-area">
          <input
            id="practiceInput"
            class="typing-input"
            type="text"
            dir="rtl"
            autocomplete="off"
          />
        </div>

        <div class="bottom-row">
          <div class="stats">
            <span id="practiceAccuracy">정확도: 100%</span>
            <span id="practiceLength">0 / 0 글자</span>
          </div>
          <button class="btn" id="practiceNextBtn">다음</button>
        </div>
      </div>
    </section>

    <!-- ===== 게임 탭 ===== -->
    <section class="tab-section" id="gameSection">
      <div class="game-title">게임 모드</div>
      <div class="game-desc">떨어지는 단어를 막거나, 제한 시간 안에 문장을 최대한 많이 타이핑해 보세요.</div>

      <div class="game-inner-tabs">
        <button class="game-tab-btn active" data-game="fallWord">단어 게임 (떨어지는 단어)</button>
        <button class="game-tab-btn" data-game="timeSentence">문장 게임 (타임어택)</button>
      </div>

      <!-- 단어 게임 -->
      <div class="game-content active" id="fallWordArea">
        <div class="game-center-wrap">
          <div>
            <div class="info-text">한국어 + 아랍어</div>
            <div class="game-meaning-box" id="fallMeaning">단어의 뜻이 여기에 표시됩니다.</div>
          </div>

          <div>
            <div class="info-text">떨어지는 아랍어 단어</div>
            <div class="fall-wrapper">
              <div class="fall-word" id="fallWord"></div>
            </div>
          </div>

          <div>
            <div class="info-text">타이핑 결과</div>
            <div class="game-typed-display" id="fallTypedDisplay"></div>
          </div>

          <div>
            <div class="info-text">정답 아랍어</div>
            <div class="game-arabic-box" id="fallTargetDisplay"></div>
          </div>

          <div class="input-area">
            <input
              id="fallInput"
              class="game-input"
              type="text"
              dir="rtl"
              autocomplete="off"
            />
          </div>

          <div class="game-stats-row">
            <div>
              <span id="fallScore">점수: 0</span> ·
              <span id="fallSpeedInfo">속도: 1.0x</span>
            </div>
            <div>
              <span id="fallStatus">준비 완료</span>
              <button class="btn" id="fallStartBtn" style="margin-left: 8px;">게임 시작</button>
            </div>
          </div>
        </div>
      </div>

      <!-- 문장 게임: 타임어택 -->
      <div class="game-content" id="timeSentenceArea">
        <div class="game-center-wrap">
          <div>
            <div class="info-text">한국어 + 아랍어</div>
            <div class="game-meaning-box" id="timeMeaning">한국어 뜻이 여기에 표시됩니다.</div>
          </div>

          <div>
            <div class="info-text">아랍어</div>
            <div class="game-arabic-box" id="timeTargetDisplay"></div>
          </div>

          <div>
            <div class="info-text">타이핑 결과</div>
            <div class="game-typed-display" id="timeTypedDisplay"></div>
          </div>

          <div class="input-area">
            <input
              id="timeInput"
              class="game-input"
              type="text"
              dir="rtl"
              autocomplete="off"
            />
          </div>

          <div class="game-stats-row">
            <div>
              <span id="timeLeft">남은 시간: 30초</span> ·
              <span id="timeScore">완료한 문제: 0개</span>
            </div>
            <div>
              <span id="timeAccuracy">정확도: 100%</span>
              <button class="btn" id="timeStartBtn" style="margin-left: 8px;">시작</button>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <script>
    // ===== 데이터 =====
    const exercises = [
      { type: "word", meaning: "책상", text: "مَكْتَبٌ" },
      { type: "word", meaning: "학교", text: "مَدْرَسَةٌ" },
      { type: "word", meaning: "친구", text: "صَدِيقٌ" },
      { type: "sentence-short", meaning: "제 이름은 지훈입니다.", text: "اِسْمِي جِهُون." },
      { type: "sentence-short", meaning: "만나서 반갑습니다.", text: "تَشَرَّفْتُ بِمَعْرِفَتِكَ." },
      { type: "sentence-long", meaning: "나는 아랍어를 조금만 말할 수 있습니다.", text: "أَسْتَطِيعُ أَنْ أَتَحَدَّثَ الْعَرَبِيَّةَ قَلِيلًا فَقَطْ." },
      { type: "sentence-long", meaning: "오늘은 대학에서 아랍어 수업을 듣고 친구들과 도서관에 갔습니다.", text: "الْيَوْمَ حَضَرْتُ دَرْسًا فِي الْعَرَبِيَّةِ فِي الْجَامِعَةِ، ثُمَّ ذَهَبْتُ مَعَ أَصْدِقَائِي إِلَى الْمَكْتَبَةِ." }
    ];

    function colorizeText(target, typed) {
      const maxLen = Math.max(target.length, typed.length);
      let html = "";
      let correctCount = 0;

      for (let i = 0; i < maxLen; i++) {
        const targetChar = target[i] || "";
        const typedChar = typed[i] || "";

        if (!typedChar) continue;

        if (typedChar === targetChar) {
          html += `<span class="correct-char">${typedChar}</span>`;
          correctCount++;
        } else {
          html += `<span class="wrong-char">${typedChar}</span>`;
        }
      }
      return { html, correctCount };
    }

    // ===== 메인 탭 =====
    const mainTabButtons = document.querySelectorAll(".main-tab-btn");
    const practiceSection = document.getElementById("practiceSection");
    const gameSection = document.getElementById("gameSection");

    let currentMode = "word"; // word / short / long

    mainTabButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        mainTabButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        const tab = btn.dataset.tab;
        if (tab === "game") {
          practiceSection.classList.remove("active");
          gameSection.classList.add("active");
        } else {
          gameSection.classList.remove("active");
          practiceSection.classList.add("active");
          currentMode = tab;
          setupPracticeMode();
        }
      });
    });

    // ===== 연습 모드 =====
    const modeTitle = document.getElementById("modeTitle");
    const practiceMeaning = document.getElementById("practiceMeaning");
    const practiceTarget = document.getElementById("practiceTarget");
    const practiceTypedDisplay = document.getElementById("practiceTypedDisplay");
    const practiceInput = document.getElementById("practiceInput");
    const practiceAccuracy = document.getElementById("practiceAccuracy");
    const practiceLength = document.getElementById("practiceLength");
    const practiceNextBtn = document.getElementById("practiceNextBtn");

    let practiceList = [];
    let practiceIndex = 0;
    let practiceCurrent = null;

    function setupPracticeMode() {
      if (currentMode === "word") {
        modeTitle.textContent = "단어";
        practiceList = exercises.filter(ex => ex.type === "word");
      } else if (currentMode === "short") {
        modeTitle.textContent = "문장";
        practiceList = exercises.filter(ex => ex.type === "sentence-short");
      } else {
        modeTitle.textContent = "긴 글";
        practiceList = exercises.filter(ex => ex.type === "sentence-long");
      }

      if (practiceList.length === 0) {
        practiceMeaning.textContent = "연습할 문장이 없습니다.";
        practiceTarget.textContent = "";
        practiceTypedDisplay.innerHTML = "";
        practiceInput.value = "";
        practiceAccuracy.textContent = "정확도: -";
        practiceLength.textContent = "0 / 0 글자";
        return;
      }

      practiceIndex = 0;
      loadPracticeItem();
    }

    function loadPracticeItem() {
      practiceCurrent = practiceList[practiceIndex];
      practiceMeaning.textContent = practiceCurrent.meaning;
      practiceTarget.textContent = practiceCurrent.text;
      practiceTypedDisplay.innerHTML = "";
      practiceInput.value = "";
      practiceAccuracy.textContent = "정확도: 100%";
      practiceLength.textContent = `0 / ${practiceCurrent.text.length} 글자`;
      practiceInput.focus();
    }

    function updatePracticeTyping() {
      if (!practiceCurrent) return;
      const typed = practiceInput.value;
      const target = practiceCurrent.text;
      const { html, correctCount } = colorizeText(target, typed);
      practiceTypedDisplay.innerHTML = html;

      const totalTyped = typed.length;
      const accuracy = totalTyped === 0 ? 100 : Math.round((correctCount / totalTyped) * 100);
      practiceAccuracy.textContent = `정확도: ${accuracy}%`;
      practiceLength.textContent = `${typed.length} / ${target.length} 글자`;
    }

    practiceInput.addEventListener("input", updatePracticeTyping);

    practiceNextBtn.addEventListener("click", () => {
      if (practiceList.length === 0) return;
      practiceIndex = (practiceIndex + 1) % practiceList.length;
      loadPracticeItem();
    });

    // 초기 연습 세팅
    setupPracticeMode();

    // ===== 게임 탭 내부 전환 =====
    const gameTabButtons = document.querySelectorAll(".game-tab-btn");
    const fallWordArea = document.getElementById("fallWordArea");
    const timeSentenceArea = document.getElementById("timeSentenceArea");

    gameTabButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        gameTabButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        const gameType = btn.dataset.game;
        if (gameType === "fallWord") {
          fallWordArea.classList.add("active");
          timeSentenceArea.classList.remove("active");
        } else {
          timeSentenceArea.classList.add("active");
          fallWordArea.classList.remove("active");
        }
      });
    });

    // ===== 단어 게임: 떨어지는 단어 =====
    const fallMeaning = document.getElementById("fallMeaning");
    const fallWordEl = document.getElementById("fallWord");
    const fallTypedDisplay = document.getElementById("fallTypedDisplay");
    const fallTargetDisplay = document.getElementById("fallTargetDisplay");
    const fallInput = document.getElementById("fallInput");
    const fallScoreEl = document.getElementById("fallScore");
    const fallSpeedInfo = document.getElementById("fallSpeedInfo");
    const fallStatus = document.getElementById("fallStatus");
    const fallStartBtn = document.getElementById("fallStartBtn");

    let fallState = {
      active: false,
      score: 0,
      y: 0,
      speed: 0.5,
      timerId: null,
      current: null
    };

    function getRandomWord() {
      const wordList = exercises.filter(ex => ex.type === "word");
      if (wordList.length === 0) return null;
      const idx = Math.floor(Math.random() * wordList.length);
      return wordList[idx];
    }

    function startFallRound() {
      fallState.current = getRandomWord();
      if (!fallState.current) return;

      fallState.y = 0;
      fallWordEl.style.transform = "translate(50%, 0%)";
      fallWordEl.textContent = fallState.current.text;
      fallMeaning.textContent = `${fallState.current.meaning}`;
      fallTargetDisplay.textContent = fallState.current.text;
      fallTypedDisplay.innerHTML = "";
      fallInput.value = "";
      fallInput.focus();
    }

    function updateFallingPosition() {
      if (!fallState.active) return;
      fallState.y += fallState.speed;

      if (fallState.y >= 100) {
        fallWordEl.style.transform = "translate(50%, 100%)";
        stopFallGame(false);
      } else {
        fallWordEl.style.transform = `translate(50%, ${fallState.y}%)`;
      }
    }

    function startFallGame() {
      if (fallState.active) return;

      fallState.active = true;
      fallState.score = 0;
      fallState.speed = 0.8;
      fallScoreEl.textContent = `점수: ${fallState.score}`;
      fallSpeedInfo.textContent = `속도: ${fallState.speed.toFixed(1)}x`;
      fallStatus.textContent = "진행 중...";
      startFallRound();

      if (fallState.timerId) clearInterval(fallState.timerId);
      fallState.timerId = setInterval(updateFallingPosition, 80);
    }

    function stopFallGame(cleared = false) {
      fallState.active = false;
      if (fallState.timerId) {
        clearInterval(fallState.timerId);
        fallState.timerId = null;
      }
      if (cleared) {
        fallStatus.textContent = "성공! 다음 단어로...";
      } else {
        fallStatus.textContent = `게임 오버 · 최종 점수: ${fallState.score}`;
      }
    }

    function handleFallInput() {
      if (!fallState.active || !fallState.current) return;
      const typed = fallInput.value;
      const target = fallState.current.text;
      const { html } = colorizeText(target, typed);
      fallTypedDisplay.innerHTML = html;

      if (typed === target) {
        fallState.score++;
        fallScoreEl.textContent = `점수: ${fallState.score}`;
        fallState.speed += 0.1;
        fallSpeedInfo.textContent = `속도: ${fallState.speed.toFixed(1)}x`;
        stopFallGame(true);

        setTimeout(() => {
          fallStatus.textContent = "진행 중...";
          fallState.active = true;
          startFallRound();
        }, 700);
      }
    }

    fallStartBtn.addEventListener("click", startFallGame);
    fallInput.addEventListener("input", handleFallInput);

    // ===== 문장 게임: 타임어택 =====
    const timeMeaning = document.getElementById("timeMeaning");
    const timeTargetDisplay = document.getElementById("timeTargetDisplay");
    const timeTypedDisplay = document.getElementById("timeTypedDisplay");
    const timeInput = document.getElementById("timeInput");
    const timeLeftEl = document.getElementById("timeLeft");
    const timeScoreEl = document.getElementById("timeScore");
    const timeAccuracyEl = document.getElementById("timeAccuracy");
    const timeStartBtn = document.getElementById("timeStartBtn");

    let timeState = {
      active: false,
      timeLeft: 30,
      timerId: null,
      score: 0,
      current: null
    };

    function getRandomSentence() {
      const list = exercises.filter(ex => ex.type === "sentence-short" || ex.type === "sentence-long");
      if (list.length === 0) return null;
      const idx = Math.floor(Math.random() * list.length);
      return list[idx];
    }

    function loadTimeQuestion() {
      timeState.current = getRandomSentence();
      if (!timeState.current) return;

      timeMeaning.textContent = timeState.current.meaning;
      timeTargetDisplay.textContent = timeState.current.text;
      timeTypedDisplay.innerHTML = "";
      timeInput.value = "";
      timeInput.focus();
    }

    function updateTimeTyping() {
      if (!timeState.active || !timeState.current) return;

      const typed = timeInput.value;
      const target = timeState.current.text;
      const { html, correctCount } = colorizeText(target, typed);
      timeTypedDisplay.innerHTML = html;

      if (typed === target) {
        timeState.score++;
        timeScoreEl.textContent = `완료한 문제: ${timeState.score}개`;
        loadTimeQuestion();
      }

      const totalTyped = typed.length;
      const acc = totalTyped === 0 ? 100 : Math.round((correctCount / totalTyped) * 100);
      timeAccuracyEl.textContent = `정확도: ${acc}%`;
    }

    function startTimeAttack() {
      if (timeState.active) return;

      timeState.active = true;
      timeState.timeLeft = 30;
      timeState.score = 0;
      timeScoreEl.textContent = "완료한 문제: 0개";
      timeLeftEl.textContent = `남은 시간: ${timeState.timeLeft}초`;
      timeAccuracyEl.textContent = "정확도: 100%";
      loadTimeQuestion();

      if (timeState.timerId) clearInterval(timeState.timerId);
      timeState.timerId = setInterval(() => {
        timeState.timeLeft--;
        timeLeftEl.textContent = `남은 시간: ${timeState.timeLeft}초`;

        if (timeState.timeLeft <= 0) {
          endTimeAttack();
        }
      }, 1000);
    }

    function endTimeAttack() {
      timeState.active = false;
      if (timeState.timerId) {
        clearInterval(timeState.timerId);
        timeState.timerId = null;
      }
      timeLeftEl.textContent = `시간 종료 · 최종 점수: ${timeState.score}개`;
    }

    timeStartBtn.addEventListener("click", startTimeAttack);
    timeInput.addEventListener("input", updateTimeTyping);
  </script>
</body>
</html>
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>아랍어 타자 연습</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f3f3f3;
      color: #111;
      display: flex;
      justify-content: center;
      align-items: stretch;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      width: 100%;
      max-width: 1100px;
      background: #fff;
      border-radius: 16px;
      padding: 20px 24px 28px;
      box-shadow: 0 10px 26px rgba(0,0,0,0.08);
      display: flex;
      flex-direction: column;
      min-height: 90vh;
    }

    .app-title {
      text-align: center;
      font-size: 1.6rem;
      font-weight: 700;
      margin-bottom: 14px;
    }

    .main-tabs {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 18px;
      flex-wrap: wrap;
    }

    .main-tab-btn {
      padding: 8px 16px;
      border-radius: 999px;
      border: 1px solid #ccc;
      background: #fafafa;
      font-size: 0.9rem;
      cursor: pointer;
    }

    .main-tab-btn.active {
      background: #2196f3;
      border-color: #2196f3;
      color: #fff;
    }

    .tab-section {
      flex: 1;
      display: none;
      /* 가운데 정렬 느낌을 위해 */
      display: none;
    }

    .tab-section.active {
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      min-height: 0;
    }

    /* ===== 공통 레이아웃 (연습) ===== */

    .mode-title {
      text-align: center;
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 14px;
    }

    .center-wrap {
      max-width: 780px;
      margin: 0 auto;
      text-align: center;
      display: flex;
      flex-direction: column;
      gap: 14px;
      flex: 1;
    }

    .info-text {
      font-size: 0.9rem;
      color: #666;
      margin-bottom: 4px;
    }

    .box {
      background: #f1f1f1;
      border-radius: 10px;
      padding: 12px 14px;
      text-align: center;
    }

    .meaning-box {
      font-size: 1rem;
      color: #333;
    }

    .arabic-box {
      font-size: 1.6rem;
      direction: rtl;
      text-align: center;
      color: #111; /* 진한 검정 */
      word-wrap: break-word;
      line-height: 1.8;
    }

    .typed-display {
      min-height: 34px;
      font-size: 1.6rem;
      direction: rtl;
      text-align: center;
      word-wrap: break-word;
      line-height: 1.8;
    }

    .input-area {
      margin-top: 6px;
    }

    .typing-input {
      width: 100%;
      max-width: 640px;
      padding: 10px 12px;
      font-size: 1.2rem;
      direction: rtl;
      text-align: center;
      border-radius: 10px;
      border: 1px solid #ccc;
      outline: none;
    }

    .typing-input:focus {
      border-color: #2196f3;
      box-shadow: 0 0 0 2px rgba(33,150,243,0.12);
    }

    .bottom-row {
      margin-top: 14px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      font-size: 0.9rem;
      color: #666;
      flex-wrap: wrap;
    }

    .stats {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      justify-content: flex-start;
    }

    .btn {
      padding: 8px 16px;
      border-radius: 999px;
      border: none;
      background: #2196f3;
      color: #fff;
      cursor: pointer;
      font-size: 0.9rem;
      white-space: nowrap;
    }

    .btn:active {
      transform: translateY(1px);
    }

    .correct-char {
      color: #111;
    }

    .wrong-char {
      color: #e53935;
    }

    /* ===== 게임 영역 ===== */

    .game-title {
      text-align: center;
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .game-desc {
      text-align: center;
      font-size: 0.9rem;
      color: #666;
      margin-bottom: 14px;
    }

    .game-inner-tabs {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }

    .game-tab-btn {
      padding: 6px 14px;
      border-radius: 999px;
      border: 1px solid #ccc;
      background: #fafafa;
      font-size: 0.85rem;
      cursor: pointer;
    }

    .game-tab-btn.active {
      background: #ff9800;
      border-color: #ff9800;
      color: #fff;
    }

    .game-content {
      flex: 1;
      display: none;
      flex-direction: column;
    }

    .game-content.active {
      display: flex;
      flex-direction: column;
    }

    .game-center-wrap {
      max-width: 780px;
      margin: 0 auto;
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 12px;
      text-align: center;
    }

    .game-meaning-box {
      background: #f1f1f1;
      border-radius: 10px;
      padding: 10px 14px;
      font-size: 0.95rem;
      color: #333;
    }

    .game-arabic-box {
      background: #f1f1f1;
      border-radius: 10px;
      padding: 10px 14px;
      font-size: 1.5rem;
      direction: rtl;
      text-align: center;
      color: #111;
      word-wrap: break-word;
      line-height: 1.7;
    }

    .game-typed-display {
      min-height: 30px;
      font-size: 1.5rem;
      direction: rtl;
      text-align: center;
      word-wrap: break-word;
      line-height: 1.7;
    }

    .game-input {
      width: 100%;
      max-width: 640px;
      padding: 8px 11px;
      font-size: 1.1rem;
      direction: rtl;
      text-align: center;
      border-radius: 10px;
      border: 1px solid #ccc;
      outline: none;
    }

    .game-input:focus {
      border-color: #ff9800;
      box-shadow: 0 0 0 2px rgba(255,152,0,0.18);
    }

    .game-stats-row {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
      font-size: 0.9rem;
      color: #666;
      align-items: center;
    }

    /* 떨어지는 단어용 영역 */
    .fall-wrapper {
      position: relative;
      height: 220px;
      overflow: hidden;
      border-radius: 12px;
      background: #fafafa;
      margin-top: 6px;
      margin-bottom: 4px;
    }

    .fall-word {
      position: absolute;
      right: 50%;
      transform: translate(50%, 0%);
      font-size: 1.9rem;
      direction: rtl;
      text-align: center;
      transition: transform 0.08s linear;
      white-space: nowrap;
    }

    @media (max-width: 768px) {
      body {
        padding: 10px;
      }

      .container {
        padding: 16px 16px 22px;
        min-height: 100vh;
      }

      .app-title {
        font-size: 1.4rem;
      }

      .arabic-box,
      .typed-display,
      .game-arabic-box,
      .game-typed-display,
      .fall-word {
        font-size: 1.4rem;
      }

      .typing-input,
      .game-input {
        font-size: 1.05rem;
      }

      .fall-wrapper {
        height: 260px; /* 모바일에서 더 길게 */
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="app-title">아랍어 타자 연습</h1>

    <!-- 메인 탭 -->
    <div class="main-tabs">
      <button class="main-tab-btn active" data-tab="word">단어 연습</button>
      <button class="main-tab-btn" data-tab="short">짧은 글 연습</button>
      <button class="main-tab-btn" data-tab="long">긴 글 연습</button>
      <button class="main-tab-btn" data-tab="game">게임 모드</button>
    </div>

    <!-- ===== 연습 탭 (단어/짧은 글/긴 글은 같은 레이아웃, 모드만 변경) ===== -->
    <section class="tab-section active" id="practiceSection">
      <div class="mode-title" id="modeTitle">단어 연습</div>
      <div class="center-wrap">
        <div>
          <div class="info-text">한국어 뜻</div>
          <div class="box meaning-box" id="practiceMeaning">제 이름은 지훈입니다.</div>
        </div>

        <div>
          <div class="info-text">아랍어</div>
          <div class="box arabic-box" id="practiceTarget">اِسْمِي جِهُون.</div>
        </div>

        <div>
          <div class="info-text">타이핑 결과</div>
          <div class="typed-display" id="practiceTypedDisplay"></div>
        </div>

        <div class="input-area">
          <input
            id="practiceInput"
            class="typing-input"
            type="text"
            dir="rtl"
            autocomplete="off"
          />
        </div>

        <div class="bottom-row">
          <div class="stats">
            <span id="practiceAccuracy">정확도: 100%</span>
            <span id="practiceLength">0 / 0 글자</span>
          </div>
          <button class="btn" id="practiceNextBtn">다음</button>
        </div>
      </div>
    </section>

    <!-- ===== 게임 탭 ===== -->
    <section class="tab-section" id="gameSection">
      <div class="game-title">게임 모드</div>
      <div class="game-desc">떨어지는 단어를 막거나, 제한 시간 안에 문장을 최대한 많이 타이핑해 보세요.</div>

      <div class="game-inner-tabs">
        <button class="game-tab-btn active" data-game="fallWord">단어 게임 (떨어지는 단어)</button>
        <button class="game-tab-btn" data-game="timeSentence">문장 게임 (타임어택)</button>
      </div>

      <!-- 단어 게임: 떨어지는 단어 -->
      <div class="game-content active" id="fallWordArea">
        <div class="game-center-wrap">
          <div>
            <div class="info-text">한국어 뜻</div>
            <div class="game-meaning-box" id="fallMeaning">단어의 뜻이 여기에 표시됩니다.</div>
          </div>

          <div>
            <div class="info-text">떨어지는 아랍어 단어</div>
            <div class="fall-wrapper">
              <div class="fall-word" id="fallWord"></div>
            </div>
          </div>

          <div>
            <div class="info-text">타이핑 결과</div>
            <div class="game-typed-display" id="fallTypedDisplay"></div>
          </div>

          <div>
            <div class="info-text">정답 아랍어</div>
            <div class="game-arabic-box" id="fallTargetDisplay"></div>
          </div>

          <div class="input-area">
            <input
              id="fallInput"
              class="game-input"
              type="text"
              dir="rtl"
              autocomplete="off"
            />
          </div>

          <div class="game-stats-row">
            <div>
              <span id="fallScore">점수: 0</span> ·
              <span id="fallSpeedInfo">속도: 1.0x</span>
            </div>
            <div>
              <span id="fallStatus">준비 완료</span>
              <button class="btn" id="fallStartBtn" style="margin-left: 8px;">게임 시작</button>
            </div>
          </div>
        </div>
      </div>

      <!-- 문장 게임: 타임어택 -->
      <div class="game-content" id="timeSentenceArea">
        <div class="game-center-wrap">
          <div>
            <div class="info-text">한국어 뜻</div>
            <div class="game-meaning-box" id="timeMeaning">한국어 뜻이 여기에 표시됩니다.</div>
          </div>

          <div>
            <div class="info-text">아랍어</div>
            <div class="game-arabic-box" id="timeTargetDisplay"></div>
          </div>

          <div>
            <div class="info-text">타이핑 결과</div>
            <div class="game-typed-display" id="timeTypedDisplay"></div>
          </div>

          <div class="input-area">
            <input
              id="timeInput"
              class="game-input"
              type="text"
              dir="rtl"
              autocomplete="off"
            />
          </div>

          <div class="game-stats-row">
            <div>
              <span id="timeLeft">남은 시간: 30초</span> ·
              <span id="timeScore">완료한 문제: 0개</span>
            </div>
            <div>
              <span id="timeAccuracy">정확도: 100%</span>
              <button class="btn" id="timeStartBtn" style="margin-left: 8px;">시작</button>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <script>
    // ===== 연습/게임 공통 데이터 =====
    const exercises = [
      {
        type: "word",
        meaning: "책상",
        text: "مَكْتَبٌ"
      },
      {
        type: "word",
        meaning: "학교",
        text: "مَدْرَسَةٌ"
      },
      {
        type: "word",
        meaning: "친구",
        text: "صَدِيقٌ"
      },
      {
        type: "sentence-short",
        meaning: "제 이름은 지훈입니다.",
        text: "اِسْمِي جِهُون."
      },
      {
        type: "sentence-short",
        meaning: "만나서 반갑습니다.",
        text: "تَشَرَّفْتُ بِمَعْرِفَتِكَ."
      },
      {
        type: "sentence-long",
        meaning: "나는 아랍어를 조금만 말할 수 있습니다.",
        text: "أَسْتَطِيعُ أَنْ أَتَحَدَّثَ الْعَرَبِيَّةَ قَلِيلًا فَقَطْ."
      },
      {
        type: "sentence-long",
        meaning: "오늘은 대학에서 아랍어 수업을 듣고 친구들과 도서관에 갔습니다.",
        text: "الْيَوْمَ حَضَرْتُ دَرْسًا فِي الْعَرَبِيَّةِ فِي الْجَامِعَةِ، ثُمَّ ذَهَبْتُ مَعَ أَصْدِقَائِي إِلَى الْمَكْتَبَةِ."
      }
    ];

    // ===== 공통: 색칠 함수 =====
    function colorizeText(target, typed) {
      const maxLen = Math.max(target.length, typed.length);
      let html = "";
      let correctCount = 0;

      for (let i = 0; i < maxLen; i++) {
        const targetChar = target[i] || "";
        const typedChar = typed[i] || "";

        if (!typedChar) continue;

        if (typedChar === targetChar) {
          html += `<span class="correct-char">${typedChar}</span>`;
          correctCount++;
        } else {
          html += `<span class="wrong-char">${typedChar}</span>`;
        }
      }
      return { html, correctCount };
    }

    // ===== 메인 탭 전환 =====
    const mainTabButtons = document.querySelectorAll(".main-tab-btn");
    const practiceSection = document.getElementById("practiceSection");
    const gameSection = document.getElementById("gameSection");

    let currentMode = "word"; // word, short, long

    mainTabButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        mainTabButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        const tab = btn.dataset.tab;
        if (tab === "game") {
          practiceSection.classList.remove("active");
          gameSection.classList.add("active");
        } else {
          gameSection.classList.remove("active");
          practiceSection.classList.add("active");
          currentMode = tab; // word / short / long
          setupPracticeMode();
        }
      });
    });

    // ===== 연습 모드 =====
    const modeTitle = document.getElementById("modeTitle");
    const practiceMeaning = document.getElementById("practiceMeaning");
    const practiceTarget = document.getElementById("practiceTarget");
    const practiceTypedDisplay = document.getElementById("practiceTypedDisplay");
    const practiceInput = document.getElementById("practiceInput");
    const practiceAccuracy = document.getElementById("practiceAccuracy");
    const practiceLength = document.getElementById("practiceLength");
    const practiceNextBtn = document.getElementById("practiceNextBtn");

    let practiceList = [];
    let practiceIndex = 0;
    let practiceCurrent = null;

    function setupPracticeMode() {
      if (currentMode === "word") {
        modeTitle.textContent = "단어 연습";
        practiceList = exercises.filter(ex => ex.type === "word");
      } else if (currentMode === "short") {
        modeTitle.textContent = "짧은 글 연습";
        practiceList = exercises.filter(ex => ex.type === "sentence-short");
      } else {
        modeTitle.textContent = "긴 글 연습";
        practiceList = exercises.filter(ex => ex.type === "sentence-long");
      }

      if (practiceList.length === 0) {
        practiceMeaning.textContent = "연습할 문장이 없습니다.";
        practiceTarget.textContent = "";
        practiceTypedDisplay.innerHTML = "";
        practiceInput.value = "";
        practiceAccuracy.textContent = "정확도: -";
        practiceLength.textContent = "0 / 0 글자";
        return;
      }

      practiceIndex = 0;
      loadPracticeItem();
    }

    function loadPracticeItem() {
      practiceCurrent = practiceList[practiceIndex];
      practiceMeaning.textContent = practiceCurrent.meaning;
      practiceTarget.textContent = practiceCurrent.text;
      practiceTypedDisplay.innerHTML = "";
      practiceInput.value = "";
      practiceAccuracy.textContent = "정확도: 100%";
      practiceLength.textContent = `0 / ${practiceCurrent.text.length} 글자`;
      practiceInput.focus();
    }

    function updatePracticeTyping() {
      if (!practiceCurrent) return;
      const typed = practiceInput.value;
      const target = practiceCurrent.text;
      const { html, correctCount } = colorizeText(target, typed);
      practiceTypedDisplay.innerHTML = html;

      const totalTyped = typed.length;
      const accuracy = totalTyped === 0 ? 100 : Math.round((correctCount / totalTyped) * 100);
      practiceAccuracy.textContent = `정확도: ${accuracy}%`;
      practiceLength.textContent = `${typed.length} / ${target.length} 글자`;
    }

    practiceInput.addEventListener("input", updatePracticeTyping);

    practiceNextBtn.addEventListener("click", () => {
      if (practiceList.length === 0) return;
      practiceIndex = (practiceIndex + 1) % practiceList.length;
      loadPracticeItem();
    });

    // 초기 연습 모드 설정
    setupPracticeMode();

    // ===== 게임 탭 내부 전환 (단어 / 문장) =====
    const gameTabButtons = document.querySelectorAll(".game-tab-btn");
    const fallWordArea = document.getElementById("fallWordArea");
    const timeSentenceArea = document.getElementById("timeSentenceArea");

    gameTabButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        gameTabButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        const gameType = btn.dataset.game;
        if (gameType === "fallWord") {
          fallWordArea.classList.add("active");
          timeSentenceArea.classList.remove("active");
        } else {
          timeSentenceArea.classList.add("active");
          fallWordArea.classList.remove("active");
        }
      });
    });

    // ===== 단어 게임: 떨어지는 단어 =====
    const fallMeaning = document.getElementById("fallMeaning");
    const fallWordEl = document.getElementById("fallWord");
    const fallTypedDisplay = document.getElementById("fallTypedDisplay");
    const fallTargetDisplay = document.getElementById("fallTargetDisplay");
    const fallInput = document.getElementById("fallInput");
    const fallScoreEl = document.getElementById("fallScore");
    const fallSpeedInfo = document.getElementById("fallSpeedInfo");
    const fallStatus = document.getElementById("fallStatus");
    const fallStartBtn = document.getElementById("fallStartBtn");

    let fallState = {
      active: false,
      score: 0,
      y: 0,
      speed: 0.5,
      timerId: null,
      current: null
    };

    function getRandomWord() {
      const wordList = exercises.filter(ex => ex.type === "word");
      if (wordList.length === 0) return null;
      const idx = Math.floor(Math.random() * wordList.length);
      return wordList[idx];
    }

    function startFallRound() {
      fallState.current = getRandomWord();
      if (!fallState.current) return;

      fallState.y = 0;
      fallWordEl.style.transform = "translate(50%, 0%)";
      fallWordEl.textContent = fallState.current.text;
      fallMeaning.textContent = fallState.current.meaning;
      fallTargetDisplay.textContent = fallState.current.text;
      fallTypedDisplay.innerHTML = "";
      fallInput.value = "";
      fallInput.focus();
    }

    function updateFallingPosition() {
      if (!fallState.active) return;
      fallState.y += fallState.speed;

      if (fallState.y >= 100) {
        fallWordEl.style.transform = "translate(50%, 100%)";
        stopFallGame(false);
      } else {
        fallWordEl.style.transform = `translate(50%, ${fallState.y}%)`;
      }
    }

    function startFallGame() {
      if (fallState.active) return;

      fallState.active = true;
      fallState.score = 0;
      fallState.speed = 0.8;
      fallScoreEl.textContent = `점수: ${fallState.score}`;
      fallSpeedInfo.textContent = `속도: ${fallState.speed.toFixed(1)}x`;
      fallStatus.textContent = "진행 중...";
      startFallRound();

      if (fallState.timerId) clearInterval(fallState.timerId);
      fallState.timerId = setInterval(updateFallingPosition, 80);
    }

    function stopFallGame(cleared = false) {
      fallState.active = false;
      if (fallState.timerId) {
        clearInterval(fallState.timerId);
        fallState.timerId = null;
      }
      if (cleared) {
        fallStatus.textContent = "성공! 다음 단어로...";
      } else {
        fallStatus.textContent = `게임 오버 · 최종 점수: ${fallState.score}`;
      }
    }

    function handleFallInput() {
      if (!fallState.active || !fallState.current) return;
      const typed = fallInput.value;
      const target = fallState.current.text;
      const { html } = colorizeText(target, typed);
      fallTypedDisplay.innerHTML = html;

      if (typed === target) {
        fallState.score++;
        fallScoreEl.textContent = `점수: ${fallState.score}`;
        fallState.speed += 0.1;
        fallSpeedInfo.textContent = `속도: ${fallState.speed.toFixed(1)}x`;
        stopFallGame(true);

        setTimeout(() => {
          fallStatus.textContent = "진행 중...";
          fallState.active = true;
          startFallRound();
        }, 700);
      }
    }

    fallStartBtn.addEventListener("click", () => {
      startFallGame();
    });
    fallInput.addEventListener("input", handleFallInput);

    // ===== 문장 게임: 타임어택 =====
    const timeMeaning = document.getElementById("timeMeaning");
    const timeTargetDisplay = document.getElementById("timeTargetDisplay");
    const timeTypedDisplay = document.getElementById("timeTypedDisplay");
    const timeInput = document.getElementById("timeInput");
    const timeLeftEl = document.getElementById("timeLeft");
    const timeScoreEl = document.getElementById("timeScore");
    const timeAccuracyEl = document.getElementById("timeAccuracy");
    const timeStartBtn = document.getElementById("timeStartBtn");

    let timeState = {
      active: false,
      timeLeft: 30,
      timerId: null,
      score: 0,
      current: null
    };

    function getRandomSentence() {
      const list = exercises.filter(ex => ex.type === "sentence-short" || ex.type === "sentence-long");
      if (list.length === 0) return null;
      const idx = Math.floor(Math.random() * list.length);
      return list[idx];
    }

    function loadTimeQuestion() {
      timeState.current = getRandomSentence();
      if (!timeState.current) return;

      timeMeaning.textContent = timeState.current.meaning;
      timeTargetDisplay.textContent = timeState.current.text;
      timeTypedDisplay.innerHTML = "";
      timeInput.value = "";
      timeInput.focus();
    }

    function updateTimeTyping() {
      if (!timeState.active || !timeState.current) return;

      const typed = timeInput.value;
      const target = timeState.current.text;
      const { html, correctCount } = colorizeText(target, typed);
      timeTypedDisplay.innerHTML = html;

      if (typed === target) {
        timeState.score++;
        timeScoreEl.textContent = `완료한 문제: ${timeState.score}개`;
        loadTimeQuestion();
      }

      const totalTyped = typed.length;
      const acc = totalTyped === 0 ? 100 : Math.round((correctCount / totalTyped) * 100);
      timeAccuracyEl.textContent = `정확도: ${acc}%`;
    }

    function startTimeAttack() {
      if (timeState.active) return;

      timeState.active = true;
      timeState.timeLeft = 30;
      timeState.score = 0;
      timeScoreEl.textContent = "완료한 문제: 0개";
      timeLeftEl.textContent = `남은 시간: ${timeState.timeLeft}초`;
      timeAccuracyEl.textContent = "정확도: 100%";
      loadTimeQuestion();

      if (timeState.timerId) clearInterval(timeState.timerId);
      timeState.timerId = setInterval(() => {
        timeState.timeLeft--;
        timeLeftEl.textContent = `남은 시간: ${timeState.timeLeft}초`;

        if (timeState.timeLeft <= 0) {
          endTimeAttack();
        }
      }, 1000);
    }

    function endTimeAttack() {
      timeState.active = false;
      if (timeState.timerId) {
        clearInterval(timeState.timerId);
        timeState.timerId = null;
      }
      timeLeftEl.textContent = `시간 종료 · 최종 점수: ${timeState.score}개`;
    }

    timeStartBtn.addEventListener("click", () => {
      startTimeAttack();
    });
    timeInput.addEventListener("input", updateTimeTyping);
  </script>
</body>
</html>
